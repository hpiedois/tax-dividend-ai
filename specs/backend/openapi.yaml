openapi: 3.0.3
info:
  title: Tax Dividend AI Backend Internal API
  version: 1.0.0
  description: Internal API for Backend Services
servers:
  - url: http://localhost:8081/internal
    description: Local development server

components:
  schemas:
    # Dividend schemas
    Dividend:
      type: object
      properties:
        id:
          type: string
          format: uuid
        securityName:
          type: string
        isin:
          type: string
        grossAmount:
          type: number
        currency:
          type: string
        paymentDate:
          type: string
          format: date
        withholdingTax:
          type: number
        reclaimableAmount:
          type: number
        status:
          type: string
          enum: [OPEN, SENT, PAID]

    TaxCalculationResultDTO:
      type: object
      properties:
        dividendId:
          type: string
          format: uuid
        success:
          type: boolean
        reclaimableAmount:
          type: number
        standardRate:
          type: number
        treatyRate:
          type: number
        withheldAmount:
          type: number
        errors:
          type: array
          items:
            type: string

    TaxCalculationBatchResultDTO:
      type: object
      properties:
        successCount:
          type: integer
        failureCount:
          type: integer
        totalReclaimableAmount:
          type: number
        results:
          type: array
          items:
            $ref: '#/components/schemas/TaxCalculationResultDTO'

    DividendStatsDTO:
      $ref: './schemas/DividendStatsDTO.yaml'

    # Bulk Import schemas
    BulkImportDividendsRequest:
      type: object
      required:
        - statementId
        - dividends
      properties:
        statementId:
          type: string
          format: uuid
          description: ID of the dividend statement being parsed
        dividends:
          type: array
          items:
            $ref: '#/components/schemas/BulkImportDividendItem'
          minItems: 1
          description: List of dividends to import

    BulkImportDividendItem:
      type: object
      required:
        - securityName
        - isin
        - paymentDate
        - grossAmount
        - currency
        - withholdingTax
        - withholdingRate
        - sourceCountry
      properties:
        securityName:
          type: string
          description: Security name (company name)
          example: LVMH
        isin:
          type: string
          description: ISIN code (12 characters)
          pattern: '^[A-Z]{2}[A-Z0-9]{10}$'
          example: FR0000121014
        paymentDate:
          type: string
          format: date
          description: Dividend payment date
        grossAmount:
          type: number
          description: Gross dividend amount
          minimum: 0
        currency:
          type: string
          description: Currency code (ISO 4217)
          pattern: '^[A-Z]{3}$'
          example: EUR
        withholdingTax:
          type: number
          description: Tax withheld at source
          minimum: 0
        withholdingRate:
          type: number
          description: Withholding rate applied (%)
          minimum: 0
          maximum: 100
        sourceCountry:
          type: string
          description: Country where dividend was paid (ISO 3166-1 alpha-2)
          pattern: '^[A-Z]{2}$'
          example: FR

    BulkImportDividendsResponse:
      type: object
      properties:
        importedCount:
          type: integer
          description: Number of dividends successfully imported
        failedCount:
          type: integer
          description: Number of dividends that failed to import
        totalGrossAmount:
          type: number
          description: Total gross amount of all imported dividends
        totalReclaimable:
          type: number
          description: Total reclaimable amount across all dividends
        dividendIds:
          type: array
          items:
            type: string
            format: uuid
          description: IDs of successfully imported dividends
        errors:
          type: array
          items:
            type: string
          description: Error messages for failed imports

    # DividendStatement schemas
    DividendStatement:
      type: object
      properties:
        id:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        sourceFileName:
          type: string
          description: Original filename of uploaded broker statement
        sourceFileS3Key:
          type: string
          description: S3/MinIO key for stored file
        broker:
          type: string
          description: Broker name (InteractiveBrokers, Swissquote, etc.)
        periodStart:
          type: string
          format: date
          description: Start of period covered by statement
        periodEnd:
          type: string
          format: date
          description: End of period covered by statement
        status:
          $ref: '#/components/schemas/DividendStatementStatus'
        parsedAt:
          type: string
          format: date-time
          nullable: true
        validatedAt:
          type: string
          format: date-time
          nullable: true
        sentAt:
          type: string
          format: date-time
          nullable: true
        sentMethod:
          type: string
          nullable: true
          description: Submission method (EMAIL, POSTAL, ONLINE)
        sentNotes:
          type: string
          nullable: true
          description: User notes about submission
        paidAt:
          type: string
          format: date-time
          nullable: true
        paidAmount:
          type: number
          nullable: true
          description: Amount received from tax authority
        parsedBy:
          type: string
          nullable: true
          description: Who/what triggered parsing (AI_AGENT, MANUAL, etc.)
        dividendCount:
          type: integer
          description: Number of dividends extracted from statement
        totalGrossAmount:
          type: number
          description: Total gross amount from all dividends
        totalReclaimable:
          type: number
          description: Total reclaimable amount from all dividends
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    DividendStatementStatus:
      type: string
      enum:
        - UPLOADED
        - PARSING
        - PARSED
        - VALIDATED
        - SENT
        - PAID
      description: |
        Status workflow for dividend statements:
        - UPLOADED: File uploaded, awaiting parsing
        - PARSING: Currently being parsed by AI Agent
        - PARSED: Parsing complete, dividends extracted
        - VALIDATED: Dividends validated, forms generated and downloaded
        - SENT: User has submitted forms to tax authority (offline)
        - PAID: Reimbursement received (marked manually by user)

    DividendStatementUpdateDTO:
      type: object
      required:
        - status
      properties:
        status:
          $ref: '#/components/schemas/DividendStatementStatus'
        sentMethod:
          type: string
          description: For SENT status - submission method
        sentNotes:
          type: string
          description: For SENT status - additional notes
        paidAmount:
          type: number
          description: For PAID status - amount received
        paidAt:
          type: string
          format: date-time
          description: For PAID status - payment date (defaults to now if not provided)
        parsedBy:
          type: string
          description: For AI Agent updates - who triggered the parsing

    # Form schemas
    FormGenerationRequest:
      $ref: './schemas/FormGenerationRequest.yaml'

    GenerateFormResultDTO:
      $ref: './schemas/GenerateFormResultDTO.yaml'

    VerifyEmailResponseDTO:
      $ref: './schemas/VerifyEmailResponseDTO.yaml'

    FormDownloadUrlResponse:
      type: object
      properties:
        url:
          type: string
          format: uri
          description: Pre-signed download URL
        expiresAt:
          type: string
          format: date-time
          description: URL expiration timestamp

    GeneratedForm:
      type: object
      properties:
        id:
          type: string
          format: uuid
        formType:
          type: string
        taxYear:
          type: integer
        fileName:
          type: string
        s3Key:
          type: string
        fileSize:
          type: integer
          format: int64
        generatedAt:
          type: string
          format: date-time
        expiresAt:
          type: string
          format: date-time

    # TaxRule schemas
    TaxRule:
      type: object
      properties:
        id:
          type: string
          format: uuid
        sourceCountry:
          type: string
        residenceCountry:
          type: string
        securityType:
          type: string
        standardWithholdingRate:
          type: number
        treatyRate:
          type: number
        reliefAtSourceAvailable:
          type: boolean
        refundProcedureAvailable:
          type: boolean
        effectiveFrom:
          type: string
          format: date
        effectiveTo:
          type: string
          format: date
        notes:
          type: string

    TreatyRateResponse:
      type: object
      properties:
        standardRate:
          type: number
        treatyRate:
          type: number
        reliefAtSourceAvailable:
          type: boolean
        refundProcedureAvailable:
          type: boolean
        notes:
          type: string

    # Auth schemas
    RegisterUserRequest:
      $ref: './schemas/RegisterUserRequest.yaml'

paths:
  # Dividend endpoints
  /dividends:
    get:
      tags:
        - Dividends
      summary: List user's dividends with optional filters
      operationId: listDividends
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
        - name: startDate
          in: query
          description: Filter dividends from this date (inclusive)
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: Filter dividends until this date (inclusive)
          schema:
            type: string
            format: date
        - name: status
          in: query
          description: Filter by submission status
          schema:
            type: string
            enum: [UNSUBMITTED, SUBMITTED, APPROVED, PAID]
      responses:
        '200':
          description: List of dividends
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Dividend'

  /dividends/{id}:
    get:
      tags:
        - Dividends
      summary: Get dividend by ID
      operationId: getDividend
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Dividend details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Dividend'
        '404':
          description: Not found

    delete:
      tags:
        - Dividends
      summary: Delete dividend
      operationId: deleteDividend
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deleted
        '404':
          description: Not found

  /dividends/status:
    patch:
      tags:
        - Dividends
      summary: Update status for multiple dividends
      operationId: updateDividendStatus
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
                    format: uuid
                status:
                  type: string
                  enum: [OPEN, SENT, PAID]
      responses:
        '204':
          description: Status updated

  /dividends/stats:
    get:
      tags:
        - Dividends
      summary: Get dividend statistics
      operationId: getDividendStats
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: taxYear
          in: query
          required: false
          schema:
            type: integer
          description: Optional tax year filter. If not provided, returns all-time stats.
      responses:
        '200':
          description: Statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendStatsDTO'

  /dividends/{id}/calculate:
    post:
      tags:
        - Dividends
      summary: Calculate tax for dividend
      operationId: calculateTax
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: residenceCountry
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxCalculationResultDTO'

  /dividends/calculate-batch:
    post:
      tags:
        - Dividends
      summary: Calculate tax for multiple dividends
      operationId: calculateBatch
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: string
                format: uuid
      responses:
        '200':
          description: Batch calculation result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxCalculationBatchResultDTO'

  /dividends/{userId}/calculate-all:
    post:
      tags:
        - Dividends
      summary: Recalculate tax for all user dividends
      description: Triggers tax recalculation for all dividends of a user. Useful after tax rule updates.
      operationId: calculateAllUserDividends
      parameters:
        - name: userId
          in: path
          required: true
          description: User ID whose dividends should be recalculated
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Tax recalculated for all dividends
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxCalculationBatchResultDTO'
        '403':
          description: Forbidden - user can only calculate their own dividends
        '404':
          description: User not found

  /dividends/bulk:
    post:
      tags:
        - Dividends
      summary: Bulk import dividends from parsed statement
      description: |
        Import multiple dividends at once from a parsed broker statement.
        Called by AI Agent after parsing a statement.
        Automatically calculates tax and updates statement metadata.
      operationId: bulkImportDividends
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkImportDividendsRequest'
      responses:
        '200':
          description: Dividends imported successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkImportDividendsResponse'
        '400':
          description: Invalid request or statement not found
        '403':
          description: User does not own the statement

  # DividendStatements endpoints
  /dividend-statements:
    post:
      tags:
        - DividendStatements
      summary: Upload broker statement
      description: Upload a broker statement PDF/CSV file. Creates a new DividendStatement with status UPLOADED.
      operationId: uploadDividendStatement
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: broker
          in: query
          required: false
          description: Broker name (InteractiveBrokers, Swissquote, etc.)
          schema:
            type: string
        - name: periodStart
          in: query
          required: false
          description: Start of period covered by statement
          schema:
            type: string
            format: date
        - name: periodEnd
          in: query
          required: false
          description: End of period covered by statement
          schema:
            type: string
            format: date
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Broker statement file (PDF or CSV)
      responses:
        '201':
          description: Statement uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendStatement'
        '400':
          description: Bad request - invalid file or parameters

    get:
      tags:
        - DividendStatements
      summary: List user's dividend statements
      description: List dividend statements with optional status filter and pagination
      operationId: listDividendStatements
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          required: false
          description: Filter by status
          schema:
            $ref: '#/components/schemas/DividendStatementStatus'
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Page of dividend statements
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/DividendStatement'
                  totalElements:
                    type: integer
                  totalPages:
                    type: integer
                  size:
                    type: integer
                  number:
                    type: integer

  /dividend-statements/{id}:
    get:
      tags:
        - DividendStatements
      summary: Get dividend statement by ID
      description: Get a specific dividend statement. Validates ownership.
      operationId: getDividendStatement
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Dividend statement details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendStatement'
        '404':
          description: Not found or not owned by user

    patch:
      tags:
        - DividendStatements
      summary: Update dividend statement status
      description: |
        Update statement status. Validates status transitions:
        - UPLOADED → PARSING (AI Agent starts parsing)
        - PARSING → PARSED (AI Agent completes parsing)
        - PARSED → VALIDATED (User downloads forms)
        - VALIDATED → SENT (User submits forms offline)
        - SENT → PAID (User receives payment)
      operationId: updateDividendStatementStatus
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DividendStatementUpdateDTO'
      responses:
        '200':
          description: Status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DividendStatement'
        '400':
          description: Invalid status transition
        '404':
          description: Not found or not owned by user

    delete:
      tags:
        - DividendStatements
      summary: Delete dividend statement
      description: Delete statement and associated file from storage
      operationId: deleteDividendStatement
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deleted successfully
        '404':
          description: Not found or not owned by user

  /dividend-statements/by-date-range:
    get:
      tags:
        - DividendStatements
      summary: Find statements by date range
      description: Find statements whose period overlaps with the specified date range
      operationId: getDividendStatementsByDateRange
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        '200':
          description: List of statements in date range
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DividendStatement'

  /dividend-statements/count-by-status:
    get:
      tags:
        - DividendStatements
      summary: Count statements by status
      description: Get count of statements for a specific status
      operationId: countDividendStatementsByStatus
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/DividendStatementStatus'
      responses:
        '200':
          description: Count of statements
          content:
            application/json:
              schema:
                type: integer
                format: int64

  # Forms endpoints
  /forms/generate:
    post:
      tags:
        - Forms
      summary: Generate tax forms
      operationId: generateForms
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FormGenerationRequest'
      responses:
        '200':
          description: Form generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerateFormResultDTO'

  /forms:
    get:
      tags:
        - Forms
      summary: List user's forms
      operationId: listForms
      parameters:
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: taxYear
          in: query
          schema:
            type: integer
        - name: formType
          in: query
          schema:
            type: string
      responses:
        '200':
          description: List of forms
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/GeneratedForm'

  /forms/{id}:
    get:
      tags:
        - Forms
      summary: Get form metadata
      operationId: getForm
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Form metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeneratedForm'
        '404':
          description: Not found

    delete:
      tags:
        - Forms
      summary: Delete form
      operationId: deleteForm
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deleted

  /forms/{id}/download:
    get:
      tags:
        - Forms
      summary: Download form
      operationId: downloadForm
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Form file
          content:
            application/pdf:
              schema:
                type: string
                format: binary
            application/zip:
              schema:
                type: string
                format: binary

  /forms/{id}/download-url:
    get:
      tags:
        - Forms
      summary: Get pre-signed download URL for form
      description: Returns a temporary pre-signed URL to download the form from storage (MinIO/S3). URL expires after specified duration.
      operationId: getFormDownloadUrl
      parameters:
        - name: id
          in: path
          required: true
          description: Form ID
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
        - name: expiresIn
          in: query
          description: URL expiration time in seconds
          schema:
            type: integer
            default: 3600
            minimum: 60
            maximum: 86400
      responses:
        '200':
          description: Pre-signed download URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FormDownloadUrlResponse'
        '404':
          description: Form not found
        '403':
          description: Forbidden - user does not own this form

  /forms/{id}/regenerate:
    post:
      tags:
        - Forms
      summary: Regenerate expired form
      description: Regenerates a form that has expired (after 30 days). The new form will have updated data and a new expiration date.
      operationId: regenerateForm
      parameters:
        - name: id
          in: path
          required: true
          description: Form ID to regenerate
          schema:
            type: string
            format: uuid
        - name: X-User-Id
          in: header
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Form regenerated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GeneratedForm'
        '404':
          description: Form not found
        '403':
          description: Forbidden - user does not own this form
        '400':
          description: Bad request - form is not expired yet

  # Tax Rules endpoints
  /tax-rules:
    get:
      tags:
        - TaxRules
      summary: List tax rules with optional filters
      description: Retrieve tax rules with optional filtering by countries, active status, and procedure availability
      operationId: getAllTaxRules
      parameters:
        - name: sourceCountry
          in: query
          description: Filter by source country (ISO 3166-1 alpha-2 code)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
          example: FR
        - name: residenceCountry
          in: query
          description: Filter by residence country (ISO 3166-1 alpha-2 code)
          schema:
            type: string
            pattern: '^[A-Z]{2}$'
          example: CH
        - name: active
          in: query
          description: Filter by active status (rules effective as of today)
          schema:
            type: boolean
        - name: reliefAtSource
          in: query
          description: Filter by relief at source availability
          schema:
            type: boolean
        - name: refundProcedure
          in: query
          description: Filter by refund procedure availability
          schema:
            type: boolean
      responses:
        '200':
          description: List of tax rules
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TaxRule'

  /tax-rules/{id}:
    get:
      tags:
        - TaxRules
      summary: Get tax rule by ID
      operationId: getTaxRule
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Tax rule details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxRule'
        '404':
          description: Not found

  /tax-rules/applicable:
    get:
      tags:
        - TaxRules
      summary: Find applicable tax rule
      operationId: findApplicableRule
      parameters:
        - name: sourceCountry
          in: query
          required: true
          schema:
            type: string
        - name: residenceCountry
          in: query
          required: true
          schema:
            type: string
        - name: securityType
          in: query
          schema:
            type: string
            default: EQUITY
        - name: date
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Applicable rule
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxRule'
        '404':
          description: No rule found

  /tax-rules/treaty-rate:
    get:
      tags:
        - TaxRules
      summary: Get treaty rate
      operationId: getTreatyRate
      parameters:
        - name: sourceCountry
          in: query
          required: true
          schema:
            type: string
        - name: residenceCountry
          in: query
          required: true
          schema:
            type: string
        - name: securityType
          in: query
          schema:
            type: string
            default: EQUITY
        - name: date
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Treaty rate details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TreatyRateResponse'
        '404':
          description: No treaty found

  # Auth endpoints (existing)
  /auth/register:
    post:
      tags:
        - Auth
      summary: Register a new user
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterUserRequest'
      responses:
        '200':
          description: Registration pending verification
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  message:
                    type: string

  /auth/verify:
    post:
      tags:
        - Auth
      summary: Verify user email
      operationId: verifyEmail
      parameters:
        - name: token
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Email verified successfully
          content:
            application/json:
              schema:
                $ref: './schemas/VerifyEmailResponseDTO.yaml'
        '400':
          description: Invalid token

  # PDF endpoints (existing)
  /pdf/generate:
    $ref: './paths/pdf-generate.yaml'
